DROP TABLE IF EXISTS combined_dataset;

CREATE TABLE combined_dataset AS
SELECT
  h3,
  res_11,
  "year",  
  borough_norm AS borough,            -- keep as-is; cast both sides if their types differ
  datetime,
  geometry,
  dt_year,
  dt_month,
  dt_day,
  dt_hour,
  dt_is_weekend,
  dt_is_weekday,
  temp,
  dwpt,
  rhum,
  prcp,
  snow,
  wdir,
  wspd,
  wpgt,
  pres,
  tsun,
  coco,
  lanes_num_avg,
  lanes_num_max,
  width_m_avg,
  width_m_max,
  incline_pc_avg,
  incline_abs_pc_avg,
  maxspeed_mph_avg,
  maxspeed_mph_max,
  n_left_lanes_avg,
  n_through_lanes_avg,
  n_right_lanes_avg,
  bus_routes_cnt_sum,
  bus_routes_cnt_max,
  smoothness_score_avg,
  cnt_is_motorway,
  cnt_is_trunk,
  cnt_is_primary,
  cnt_is_secondary,
  cnt_is_tertiary,
  cnt_is_residential,
  cnt_is_service,
  cnt_is_track_or_path,
  cnt_is_foot_or_ped,
  cnt_has_pt_stop,
  cnt_is_paved,
  cnt_is_nsl,
  cnt_speed_var_or_none,
  cnt_has_signals,
  cnt_has_traffic_calming,
  cnt_has_crossing,
  cnt_crossing_signalised,
  cnt_crossing_zebra,
  cnt_has_cycle_infra,
  cnt_has_contraflow_cycle,
  cnt_has_cycle_track,
  cnt_has_cycle_lane,
  cnt_is_lit,
  cnt_has_lit_schedule,
  cnt_motor_restricted,
  cnt_hgv_restricted,
  cnt_psv_priority,
  cnt_bus_priority,
  cnt_is_bridge,
  cnt_is_tunnel,
  cnt_has_barrier,
  cnt_has_amenity,
  cnt_has_bus_stop,
  cnt_has_mini_roundabout,
  cnt_has_speed_camera,
  cnt_overtaking_allowed,
  cnt_oneway_forward,
  cnt_oneway_bidirectional,
  cnt_oneway_reverse,
  cnt_surface_paved,
  cnt_surface_unpaved,
  cnt_surface_asphalt,
  cnt_surface_gravel,
  cnt_surface_dirt,
  cnt_sidewalk_both,
  cnt_sidewalk_left,
  cnt_sidewalk_right,
  cnt_sidewalk_none,
  cnt_bicycle_yes,
  cnt_bicycle_designated,
  cnt_bicycle_permissive,
  cnt_bicycle_no,
  cnt_access_permissive,
  cnt_access_destination,
  cnt_access_private,
  cnt_access_no,
  cnt_litmode_always,
  cnt_litmode_limited,
  share_is_motorway,
  share_is_trunk,
  share_is_primary,
  share_is_secondary,
  share_is_tertiary,
  share_is_residential,
  share_is_service,
  share_is_track_or_path,
  share_is_foot_or_ped,
  r11_n_collisions,
  r11_mean_n_osm_features,
  r11_total_osm_features,
  r11_mean_maxspeed_mph,
  r11_mean_lanes,
  r11_mean_width_m,
  r11_mean_smoothness,
  r11_mean_cnt_has_signals,
  r11_mean_cnt_has_crossing,
  r11_mean_cnt_speed_camera,
  r11_mean_cnt_bus_stop,
  r11_mean_cnt_amenity,
  r11_mean_cnt_is_primary,
  r11_mean_cnt_is_secondary,
  r11_mean_cnt_is_tertiary,
  r11_mean_cnt_is_residential,
  r11_mean_cnt_is_service,
  r11_mean_cnt_is_track_or_path,
  r11_share_is_primary,
  r11_share_is_secondary,
  r11_share_is_tertiary,
  r11_share_is_residential,
  r11_share_is_service,
  r11_share_is_track_or_path,
  r11_share_oneway_forward,
  r11_share_oneway_bidirectional,
  r11_share_oneway_reverse,
  r11_mean_cnt_sidewalk_none,
  r11_mean_cnt_sidewalk_both,
  r11_mean_cnt_cycle_infra,
  r11_mean_cnt_cycle_lane,
  r11_mean_cnt_cycle_track,
  1::smallint AS collision
FROM collision_dataset

UNION ALL

SELECT
  h3,
  res_11,
  "year",
  borough,
  datetime,
  geometry,
  dt_year,
  dt_month,
  dt_day,
  dt_hour,
  dt_is_weekend,
  dt_is_weekday,
  temp,
  dwpt,
  rhum,
  prcp,
  snow,
  wdir,
  wspd,
  wpgt,
  pres,
  tsun,
  coco,
  lanes_num_avg,
  lanes_num_max,
  width_m_avg,
  width_m_max,
  incline_pc_avg,
  incline_abs_pc_avg,
  maxspeed_mph_avg,
  maxspeed_mph_max,
  n_left_lanes_avg,
  n_through_lanes_avg,
  n_right_lanes_avg,
  bus_routes_cnt_sum,
  bus_routes_cnt_max,
  smoothness_score_avg,
  cnt_is_motorway,
  cnt_is_trunk,
  cnt_is_primary,
  cnt_is_secondary,
  cnt_is_tertiary,
  cnt_is_residential,
  cnt_is_service,
  cnt_is_track_or_path,
  cnt_is_foot_or_ped,
  cnt_has_pt_stop,
  cnt_is_paved,
  cnt_is_nsl,
  cnt_speed_var_or_none,
  cnt_has_signals,
  cnt_has_traffic_calming,
  cnt_has_crossing,
  cnt_crossing_signalised,
  cnt_crossing_zebra,
  cnt_has_cycle_infra,
  cnt_has_contraflow_cycle,
  cnt_has_cycle_track,
  cnt_has_cycle_lane,
  cnt_is_lit,
  cnt_has_lit_schedule,
  cnt_motor_restricted,
  cnt_hgv_restricted,
  cnt_psv_priority,
  cnt_bus_priority,
  cnt_is_bridge,
  cnt_is_tunnel,
  cnt_has_barrier,
  cnt_has_amenity,
  cnt_has_bus_stop,
  cnt_has_mini_roundabout,
  cnt_has_speed_camera,
  cnt_overtaking_allowed,
  cnt_oneway_forward,
  cnt_oneway_bidirectional,
  cnt_oneway_reverse,
  cnt_surface_paved,
  cnt_surface_unpaved,
  cnt_surface_asphalt,
  cnt_surface_gravel,
  cnt_surface_dirt,
  cnt_sidewalk_both,
  cnt_sidewalk_left,
  cnt_sidewalk_right,
  cnt_sidewalk_none,
  cnt_bicycle_yes,
  cnt_bicycle_designated,
  cnt_bicycle_permissive,
  cnt_bicycle_no,
  cnt_access_permissive,
  cnt_access_destination,
  cnt_access_private,
  cnt_access_no,
  cnt_litmode_always,
  cnt_litmode_limited,
  share_is_motorway,
  share_is_trunk,
  share_is_primary,
  share_is_secondary,
  share_is_tertiary,
  share_is_residential,
  share_is_service,
  share_is_track_or_path,
  share_is_foot_or_ped,
  r11_n_collisions,
  r11_mean_n_osm_features,
  r11_total_osm_features,
  r11_mean_maxspeed_mph,
  r11_mean_lanes,
  r11_mean_width_m,
  r11_mean_smoothness,
  r11_mean_cnt_has_signals,
  r11_mean_cnt_has_crossing,
  r11_mean_cnt_speed_camera,
  r11_mean_cnt_bus_stop,
  r11_mean_cnt_amenity,
  r11_mean_cnt_is_primary,
  r11_mean_cnt_is_secondary,
  r11_mean_cnt_is_tertiary,
  r11_mean_cnt_is_residential,
  r11_mean_cnt_is_service,
  r11_mean_cnt_is_track_or_path,
  r11_share_is_primary,
  r11_share_is_secondary,
  r11_share_is_tertiary,
  r11_share_is_residential,
  r11_share_is_service,
  r11_share_is_track_or_path,
  r11_share_oneway_forward,
  r11_share_oneway_bidirectional,
  r11_share_oneway_reverse,
  r11_mean_cnt_sidewalk_none,
  r11_mean_cnt_sidewalk_both,
  r11_mean_cnt_cycle_infra,
  r11_mean_cnt_cycle_lane,
  r11_mean_cnt_cycle_track,
  0::smallint AS collision
FROM negative_dataset;
